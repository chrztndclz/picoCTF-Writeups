# logon

**Platform:** picoCTF 2019
**Author:**  BOBSON
**Category:**  Web Exploitation
**Difficulty:** Easy

---

## Description
The factory is hiding things from all of its users. Can you login as Joe and find what they've been looking at? https://jupiter.challenges.picoctf.org/problem/13594/ (link) or http://jupiter.challenges.picoctf.org:13594

---

## Hints
- Hmm it doesn't seem to check anyone's password, except for Joe's?

---

## Analysis

The challenge involves a login page where you can enter any username and password. The hint suggests that the site doesn’t actually verify most passwords, so the vulnerability might involve client-side authentication — meaning something stored in cookies or local storage decides what you can access.

Our goal is to log in and find what Joe sees — likely hidden behind admin access or elevated permissions.


---

## Methodology

Step 1: Open the challenge URL in your browser.

Step 2: You’ll see a simple login form. Try a few credentials.
- `Username: Joe`, `Password: Joe` → Error: _"I'm sorry Joe's password is super secure. You're not getting in that way"_

- `Username: Admin`, `Password: Admin` → Message: _"Success: You logged in! Not sure you'll be able to see the flag though."_

From those two results you can tell the site behaves differently for different usernames. It looks like it **does not check passwords for most users**, but it **does** enforce a password check specifically for the username **Joe**. That means the app is probably using a weak or unusual method to decide who can log in.

Step 3: Open your browser’s Developer Tools (`F12` or `Ctrl+Shift+I`) and switch to the **Application** (Chrome) or **Storage** (Firefox) panel.

Step 4: Look under **Storage → Cookies** for the challenge domain. Also quickly glance at Local Storage or Session Storage — these are places the site can keep small bits of information for your browser

Websites often store little pieces of information (like “you are logged in” or “you are an admin”) in cookies or local storage. If the server trusts those values without checking them again, you can change them in your browser to change what the site thinks about you.

Step 5: Locate a cookie or storage entry named `admin` (or something similar). You should see its value is `False`.

That `admin` value is the site’s way of marking whether a user is an administrator. If the server trusts this client-side value, then editing it will change what the site lets you see.

Step 6: Edit the cookie value: double-click the `admin` value, replace `False` with `True`, and press Enter.

By changing the `admin` flag to `True`, you’re giving the site a “note” that says “I am an admin.” Because the site relies on that client-side note instead of verifying roles on the server, it believes you and grants admin-level content.


<img width="1916" height="736" alt="image" src="https://github.com/user-attachments/assets/c369b8b2-d982-458c-9d05-585609837bec" />


Step 7: Refresh the page. With `admin=True`, the site treats you as an admin and shows the flag.


---

## Flag

picoCTF{th3_'REDACTED'_d1c24fef}

---

## Reflection
This challenge teaches a key web security lesson: **never trust the client.**  
Any information stored in the browser — cookies, local storage, or session storage — can be edited by the user. Authorization (checking who can access what) must always be done on the **server side**, not on the client.

For attackers, this exercise demonstrates how to explore stored browser data for potential privilege escalation. For developers, it’s a reminder to protect sensitive logic by:

- Validating all permissions on the server.
    
- Using signed or encrypted cookies.
    
- Marking cookies as `HttpOnly` and `Secure`.
  
---

## Tools
- Web browser (Chrome/Firefox) Developer Tools → Application / Storage → Cookies
    
- Basic manual testing (login attempts, cookie editing)

----

## References

- [OWASP — Authentication and Session Management Best Practices](https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication)

- [MDN Web Docs — Using HTTP Cookies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)

