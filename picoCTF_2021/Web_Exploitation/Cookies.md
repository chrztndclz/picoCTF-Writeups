## Cookies

**Platform:** picoCTF 2021

**Author:** MADSTACKS

**Category:** Web Exploitation 

**Difficulty:** Easy

Tags:
#picoCTF_2021 
#Web_Exploitation 
#Easy 

---

## Description
Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:27177/

---

## Hints
- (none)

---

## Analysis
This is a straightforward web-exploitation / logic puzzle where the application responds differently depending on the value of a client cookie. The flag is returned when the right cookie value is set for the `name` cookie. We can solve it manually via the browser or automate by sending requests with different cookie values.

---

## Methodology

**Step 1 — Open the web app**  
Browse to `http://mercury.picoctf.net:27177/`.

**Step 2 — Inspect cookies / storage**  
Open DevTools (F12) → Application (or Storage) → Cookies. Observe the `name` cookie; initial value is `-1`.


<img width="1902" height="612" alt="image" src="https://github.com/user-attachments/assets/0812f65c-570f-4eb9-be34-a61d7885a357" />


**Step 3 — Try simple values manually**  
In the page UI there is a text box to submit cookie names. Enter `snickerdoodle` and submit. The page responds:

That is a cookie! Not very special though... I love snickerdoodle cookies!

That confirms the server reflects responses based on the cookie value.

**Step 4 — Observe server behavior**  
When you change the `name` cookie in DevTools to other values (or submit other values via the page), the server replies with different messages. The app expects a particular cookie value (integer or specific token) that triggers the flag.


<img width="1916" height="647" alt="image" src="https://github.com/user-attachments/assets/a1028bd9-900d-4c65-a4cf-0cf24f72ced9" />


Step 5 — Enumerate values
I tested sequential values starting from 0 up to 18 by submitting them (or setting the cookie), and at one of those values the server returned the flag. You can do this manually using the web UI, or automate it (see script below).

<img width="1913" height="572" alt="image" src="https://github.com/user-attachments/assets/e00b510c-3780-482b-92c3-bd9fa355c4b5" />


**Step 6: Retrieve the flag**  
When the correct cookie value is used the page shows the flag


---

## Flag

picoCTF{3v3ry1_l0v3s_c00k135_064663be}
picoCTF{3v3---------3be}

---

## Reflection
This challenge is a simple but instructive example of how client-side cookies influence application behavior. It reinforces two ideas: first, never trust client-controlled values; second, small automation scripts can save a lot of time when enumerating possible inputs. In real-world testing, always check how the server validates cookie values and whether sensitive behavior (like flag disclosure) depends on unprotected client-side data.

---

## Tools
Browser DevTools (Application / Storage → Cookies) — inspect and edit cookies.

----

## References

- [OWASP - Season Managementl](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html)
    
-  [Cookies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)

