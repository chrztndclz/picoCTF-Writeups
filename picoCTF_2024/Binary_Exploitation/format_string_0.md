
## format string 0

**Platform:** picoCTF 2024

**Author:**  CHENG ZHANG

**Category:**  Binary Exploitation

**Difficulty:** Easy

Tags:
#picoCTF_2024 
#Binary_Exploitation
#Easy 

---

## Description

Can you use your knowledge of format strings to make the customers happy? 

Download the binary here. 
Download the source here.

Additional details will be available after launching your challenge instance.

---

## Hints
- This is an introduction of format string vulnerabilities. Look up "format specifiers" if you have never seen them before.
- Just try out the different options

---

## Analysis

This challenge introduces the basic idea of format string vulnerabilities, where the program prints your input using functions like printf(input) instead of printf("%s", input). Because of this, any format specifiers inside your input (like %s, %d, %p) are interpreted as actual instructions, not plain text. The binary asks you to recommend burgers with strange names that already contain format specifiers. When you send these names back to the program, the unexpected format specifiers cause the program to read values from the stack and print unintended data. The first customer simply demonstrates how input with %114d changes the output. The second customer requires you to choose the “most format-string-chaotic” burger name, because it contains multiple % patterns that break the program and reveal the flag. In short, you're not exploiting memory deeply yet — you're just using the supplied burger name that triggers the intended vulnerability and forces the program to leak the flag.

---

## Methodology
**Step 1:** download the file and change permission to executable file. 


**Step 2:**  Connect to the challenge server:

nc mimas.picoctf.net 50237

You will see the initial menu and prompt for the first customer.


Step 3: Stage 1 (Patrick) — send the special menu entry that contains %114d:

Gr%114d_Cheese

Expected immediate effect: the program prints a long string because %114d expands to many characters (padding). The printed character count returned by printf becomes large enough to pass the check (count > 2 * BUFSIZE), and the program goes to the second customer.


Step 4: Stage 2 (Bob) — send the burger that triggers the crash on the remote server:

Cla%sic_Che%s%steak

Why this string? It contains %s format specifiers that printf will try to read from addresses on the stack. On the remote environment the particular sequence and memory layout cause printf to dereference an invalid pointer and the program segfaults.

When the program segfaults, the installed signal handler runs:

void sigsegv_handler(int sig) {
    printf("\n%s\n", flag);
    fflush(stdout);
    exit(1);
}


That prints the flag from memory (the remote server’s flag buffer), and you receive the real picoCTF flag in your netcat session.

 
<img width="1009" height="226" alt="image" src="https://github.com/user-attachments/assets/fd4dc719-7981-4e00-b65b-6f0263b7fc52" />


---

## Flag


picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_a1d85b3e}
picoCTF{7h3----------b3e}

---

## Reflection

This challenge is a gentle introduction to how format string vulnerabilities work. Instead of manually crafting malicious input, the program itself gives you burger names that already contain format directives. By feeding them back into the program, you see firsthand how %d, %s, and other specifiers can manipulate output or access unintended memory. This helps build intuition for more advanced challenges where you will need to create your own payloads to print memory addresses, read from the stack, or even write to memory. The key takeaway is that any program using printf(user_input) without proper formatting makes itself vulnerable, and even simple format specifiers can trigger unpredictable behavior — or leak sensitive data like a flag.

---

## Tools

nc (netcat)	- Connects to the remote challenge server to interact with the binary.

chmod	- Changes file permissions so the binary can be executed locally.

strings / cat - Helps inspect basic output or text files.

----

## References

[Format String Vulnerabilities (OWASP)](https://owasp.org/www-community/attacks/Format_string_attack)

[printf format specifiers (GeeksForGeeks)](https://www.geeksforgeeks.org/format-specifiers-in-c/)
